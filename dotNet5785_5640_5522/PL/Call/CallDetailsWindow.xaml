<Window x:Class="PL.Call.CallDetailsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:bo="clr-namespace:BO;assembly=BL"
        xmlns:converters="clr-namespace:PL.Converters"
        Title="Call Details"
        Height="600"
        Width="450">
    <Window.Resources>
        <converters:StatusToIsEditableConverter x:Key="StatusToIsEditableConverter"/>
        <converters:StatusToIsMaxEndTimeEditableConverter x:Key="StatusToIsMaxEndTimeEditableConverter"/>
        <converters:StatusToIsUpdatableConverter x:Key="StatusToIsUpdatableConverter"/>
        <converters:StatusToVisibilityConverter x:Key="StatusToVisibilityConverter"/>
    </Window.Resources>

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Form -->
        <StackPanel VerticalAlignment="Top">
            <Label Content="Id:" Margin="0,0,0,5"/>
            <TextBox Text="{Binding Call.Id}" IsReadOnly="True" Margin="0,0,0,10"/>

            <Label Content="Type:" Margin="0,0,0,5"/>
            <ComboBox ItemsSource="{Binding CallTypes}" SelectedItem="{Binding Call.Type}"
                      IsEnabled="{Binding Call.Status, Converter={StaticResource StatusToIsEditableConverter}}" Margin="0,0,0,10"/>

            <Label Content="Description:" Margin="0,0,0,5"/>
            <TextBox Text="{Binding Call.Description}"
                     IsReadOnly="{Binding Call.Status, Converter={StaticResource StatusToIsEditableConverter}, ConverterParameter=Invert}"
                     Margin="0,0,0,10"/>

            <Label Content="Caller Address:" Margin="0,0,0,5"/>
            <TextBox Text="{Binding Call.CallerAddress}"
                     IsReadOnly="{Binding Call.Status, Converter={StaticResource StatusToIsEditableConverter}, ConverterParameter=Invert}"
                     Margin="0,0,0,10"/>

            <Label Content="Start Time:" Margin="0,0,0,5"/>
            <TextBox Text="{Binding Call.StartTime}" IsReadOnly="True" Margin="0,0,0,10"/>

            <Label Content="Max End Time:" Margin="0,0,0,5"/>
            <DatePicker SelectedDate="{Binding Call.MaxEndTime}"
                        IsEnabled="{Binding Call.Status, Converter={StaticResource StatusToIsMaxEndTimeEditableConverter}}"
                        Margin="0,0,0,10"/>

            <Label Content="Status:" Margin="0,0,0,5"/>
            <TextBox Text="{Binding Call.Status}" IsReadOnly="True" Margin="0,0,0,10"/>

            <Label Content="Assignments:" Margin="0,0,0,5"/>
            <ListBox ItemsSource="{Binding Call.Assignments}" DisplayMemberPath="Display"
                     Visibility="{Binding Call.Assignments.Count, Converter={StaticResource StatusToVisibilityConverter}}"
                     Margin="0,0,0,10"/>
        </StackPanel>

        <!-- Save/Update -->
        <Button Grid.Row="1" Content="{Binding ButtonText}" Width="120" Height="35" HorizontalAlignment="Center" Margin="10"
                IsEnabled="{Binding Call.Status, Converter={StaticResource StatusToIsUpdatableConverter}}"
                Click="BtnAddOrUpdate_Click"/>
    </Grid>
</Window>
